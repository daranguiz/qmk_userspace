# Unified Keymap Configuration

# Base layer metadata
base_layers:
  BASE_GALLIUM:
    display_name: "GALLIUM"
    description: "Gallium colstag https://github.com/GalileoBlues/Gallium"
  BASE_NIGHT:
    display_name: "NIGHT"
    description: "Night thumb alpha"
  BASE_BUNYA:
    display_name: "BUNYA"
    description: "Bunya layout (GalileoBlues)"
  BASE_RACKET:
    display_name: "RACKET"
    description: "Racket layout (GalileoBlues)"

layers:
  BASE_NIGHT:
    core: # (3x5)
      left:
        - [B              , F              , L              , K              , Q              ]
        - [hrm:LGUI:N     , hrm:LALT:S     , hrm:LCTL:H     , hrm:LSFT:T     , M              ]
        - [X              , V              , J              , D              , Z              ]
      right:
        - [P              , G              , O              , U              , DOT            ]
        - [Y              , hrm:LSFT:C     , hrm:LCTL:A     , hrm:LALT:E     , hrm:LGUI:I     ]
        - [QUOT           , W              , MINS           , SCLN           , COMM           ]
      thumbs:
        - [lt:NUM_NIGHT:BSPC   , lt:SYM_NIGHT:R              , mt:LSFT:MAGIC    ]
        - [mt:LSFT:TAB    , lt:NAV_NIGHT:SPC     , lt:MEDIA_NIGHT:ENT    ]
    extensions:
      3x6_3:
        outer_pinky_left: [NONE, Y, NONE]
        outer_pinky_right: [NONE, NONE, NONE]   

  BASE_GALLIUM:
    core: # (3x5)
      left:
        - [B              , L              , D              , C              , V              ]
        - [hrm:LGUI:N     , hrm:LALT:R     , hrm:LCTL:T     , hrm:LSFT:S     , G              ]
        - [X              , Q              , M              , W              , Z              ]
      right:
        - [J              , Y              , O              , U              , DOT            ]
        - [P              , hrm:LSFT:H     , hrm:LCTL:A     , hrm:LALT:E     , hrm:LGUI:I     ]
        - [K              , F              , QUOT           , MINS           , COMM            ]
      thumbs:
        - [lt:NUM_NIGHT:BSPC   , lt:SYM_NIGHT:MAGIC    , mt:LSFT:DEL    ]
        - [mt:LSFT:TAB    , lt:NAV_NIGHT:SPC     , lt:MEDIA_NIGHT:ENT    ]
    extensions:
      3x6_3:
        outer_pinky_left: [NONE, NONE, NONE]
        outer_pinky_right: [NONE, ENT, NONE]

  BASE_BUNYA:
    core: # (3x5)
      left:
        - [B              , L              , M              , C              , Z              ]
        - [hrm:LGUI:N     , hrm:LALT:R     , hrm:LCTL:T     , hrm:LSFT:D     , P              ]
        - [X              , Q              , V              , G              , W              ]
      right:
        - [J              , F              , O              , U              , COMM           ]
        - [Y              , hrm:LSFT:H     , hrm:LCTL:A     , hrm:LALT:E     , hrm:LGUI:I     ]
        - [SCLN           , K              , QUOT           , MINS           , DOT            ]
      thumbs:
        - [lt:NUM_NIGHT:BSPC   , lt:SYM_NIGHT:S              , mt:LSFT:MAGIC    ]
        - [mt:LSFT:TAB    , lt:NAV_NIGHT:SPC     , lt:MEDIA_NIGHT:ENT    ]
    extensions:
      3x6_3:
        outer_pinky_left: [NONE, NONE, NONE]
        outer_pinky_right: [NONE, NONE, NONE]

  BASE_RACKET:
    core: # (3x5)
      left:
        - [F              , D              , L              , W              , J              ]
        - [hrm:LGUI:S     , hrm:LALT:T     , hrm:LCTL:H     , hrm:LSFT:C     , Y              ]
        - [X              , K              , M              , G              , V              ]
      right:
        - [MINS           , B              , O              , U              , COMM           ]
        - [Q              , hrm:LSFT:N     , hrm:LCTL:A     , hrm:LALT:E     , hrm:LGUI:I     ]
        - [Z              , P              , QUOT           , SLSH           , DOT            ]
      thumbs:
        - [lt:NUM_NIGHT:BSPC   , lt:SYM_NIGHT:R              , mt:LSFT:MAGIC    ]
        - [mt:LSFT:TAB    , lt:NAV_NIGHT:SPC     , lt:MEDIA_NIGHT:ENT    ]
    extensions:
      3x6_3:
        outer_pinky_left: [NONE, NONE, NONE]
        outer_pinky_right: [NONE, NONE, NONE]

  FUN:
    core: # (3x5)
      left:
        - [F12            , F7             , F8             , F9             , PSCR           ]
        - [F11            , F4             , F5             , F6             , SCRL           ]
        - [F10            , F1             , F2             , F3             , PAUS           ]
      right:
        - [NONE           , NONE           , NONE           , NONE           , NONE           ]
        - [NONE           , LSFT           , LCTL           , LALT           , LGUI           ]
        - [NONE           , NONE           , NONE           , NONE           , NONE           ]
      thumbs:
        - [APP            , SPC            , TAB            ]
        - [NONE           , NONE           , NONE           ]
    extensions:
      3x6_3:
        outer_pinky_left: [NONE, NONE, NONE]
        outer_pinky_right: [NONE, NONE, NONE]

  # Night-specific layers (hands flipped compared to original)
  NUM_NIGHT:
    core: # (3x5)
      left:
        - [NONE           , TILD           , PERC           , COLN           , NONE           ]
        - [LGUI           , LALT           , LCTL           , LSFT           , PIPE           ]
        - [UNDO           , CUT            , COPY           , PASTE          , REDO           ]
      right:
        - [CIRC           , 7              , 8              , 9              , DOT            ]
        - [HASH           , 1              , 2              , 3              , GRV            ]
        - [DLR            , 4              , 5              , 6              , COMM           ]
      thumbs:
        - [NONE           , NONE           , NONE           ]
        - [SLSH           , 0              , AT             ]
    extensions:
      3x6_3:
        outer_pinky_left: [NONE, NONE, NONE]
        outer_pinky_right: [NONE, NONE, NONE]

  SYM_NIGHT:
    core: # (3x5)
      left:
        - [DLR            , ASTR           , PERC           , COLN           , NONE           ]
        - [LGUI           , LALT           , LCTL           , LSFT           , EQL            ]
        - [NONE           , NONE           , NONE           , AMPR           , NONE           ]
      right:
        - [PLUS           , LABK           , LCBR           , RCBR           , RABK           ]
        - [EXLM           , QUES           , LPRN           , RPRN           , SCLN           ]
        - [BSLS           , MINS           , LBRC           , RBRC           , COMM           ]
      thumbs:
        - [NONE           , NONE           , NONE           ]
        - [SLSH           , SPC            , ENT            ]
    extensions:
      3x6_3:
        outer_pinky_left: [NONE, NONE, NONE]
        outer_pinky_right: [NONE, NONE, NONE]

  NAV_NIGHT:
    core: # (3x5)
      left:
        - [NONE           , PGUP           , NONE           , NONE           , ESC            ]
        - [NONE           , LEFT           , UP             , RGHT           , CAPS ]
        - [END            , PGDN           , DOWN           , HOME           , INS            ]
      right:
        - [BT_SEL_0       , BT_SEL_1       , BT_SEL_2       , BT_SEL_3       , BT_CLR         ]
        - [NONE           , LSFT           , LCTL           , LALT           , LGUI           ]
        - [NONE           , NONE           , NONE           , NONE           , NONE           ]
      thumbs:
        - [BSPC           , ENT            , DEL            ]
        - [NONE           , NONE           , NONE           ]
    extensions:
      3x6_3:
        outer_pinky_left: [NONE, NONE, NONE]
        outer_pinky_right: [NONE, NONE, NONE]

  MEDIA_NIGHT:
    core: # (3x5)
      left:
        - [df:BASE_NIGHT  , df:BASE_GALLIUM, df:BASE_BUNYA  , df:BASE_RACKET , NONE           ]
        - [MNXT           , VOLU           , VOLD           , MPRV           , NONE           ]
        - [UNDO           , CUT            , COPY           , PASTE          , REDO           ]
      right:
        - [NONE           , NONE           , NONE           , NONE           , NONE           ]
        - [NONE           , LSFT           , LCTL           , LALT           , LGUI           ]
        - [NONE           , NONE           , NONE           , NONE           , DFU            ]
      thumbs:
        - [MUTE           , MPLY           , MSTP           ]
        - [NONE           , NONE           , NONE           ]
    extensions:
      3x6_3:
        outer_pinky_left: [NONE, NONE, NONE]
        outer_pinky_right: [NONE, NONE, NONE]

# Combo definitions
# NOTE: Positions use canonical 36-key (3x5_3) numbering
# Positions are automatically translated for larger boards (3x6_3, etc.)
combos:
  - name: dfu_left
    description: "Enter bootloader (left hand)"
    key_positions: [0, 4, 24]  # B + Q + Z (canonical 36-key positions)
    action: DFU
    timeout_ms: 100  # Slightly longer for easier chord
    require_prior_idle_ms: 150  # Prevent during fast typing (ZMK only)
    layers: [BASE_NIGHT, BASE_GALLIUM, BASE_BUNYA, BASE_RACKET]

  - name: dfu_right
    description: "Enter bootloader (right hand)"
    key_positions: [5, 9, 25]  # P + DOT + ' (canonical 36-key positions)
    action: DFU
    timeout_ms: 100  # Slightly longer for easier chord
    require_prior_idle_ms: 150  # Prevent during fast typing (ZMK only)
    layers: [BASE_NIGHT, BASE_GALLIUM, BASE_BUNYA, BASE_RACKET]

  - name: github_url
    description: "Expand to GitHub repo URL"
    key_positions: [6, 7, 8, 9]  # G O U DOT (canonical 36-key positions)
    action: MACRO_GITHUB_URL
    macro_text: "https://github.com/daranguiz/keyboard-config?tab=readme-ov-file#readme"
    timeout_ms: 100  # Slightly longer for 4-key combo
    layers: [BASE_NIGHT, BASE_GALLIUM, BASE_BUNYA, BASE_RACKET]

# Magic key definitions
# Context-aware keys that produce different outputs based on previous keypress
# Used to provide alternate bigrams for uncomfortable key combinations
magic_keys:
  BASE_GALLIUM:
    timeout_ms: 0  # 0 = no max idle constraint for adaptive key triggers
    mappings:
      ".": "/"
      A: Y
      B: R
      C: S
      # D: (repeat)
      E: Y
      # F: (repeat)
      G: S
      # H: (repeat)
      # I: (repeat)
      # J: (repeat)
      # K: (repeat)
      # L: (repeat)
      M: B
      # N: (repeat)
      O: K
      P: H
      # Q: (repeat)
      R: L
      S: C
      # T: (repeat)
      U: E
      # V: (repeat)
      # W: (repeat)
      # X: (repeat)
      Y: E
      # Z: (repeat)
    default_repeat: true  

  BASE_NIGHT:
    timeout_ms: 0
    mappings:
      " ": THE
      ",": " BUT"
      "-": ">"
      ".": "/"
      A: O
      B: EFORE
      C: Y
      # D: (repeat)
      # E: (repeat)
      # F: (repeat)
      G: Y
      H: L
      I: ON
      J: UST
      # K: (repeat)
      # L: (repeat)
      M: ENT
      N: ION
      # O: (repeat)
      P: Y
      Q: UE
      # R: (repeat)
      # S: (repeat)
      T: ION
      U: E
      V: S
      W: HICH
      # X: (repeat)
      Y: "'"
      # Z: (repeat)
    default_repeat: true

  BASE_BUNYA:
    timeout_ms: 0
    mappings:
      " ": THE
      ",": " BUT"
      ".": "/"
      "/": ">"
    default_repeat: true

  BASE_RACKET:
    timeout_ms: 0
    mappings:
      ".": "/"
    default_repeat: true
